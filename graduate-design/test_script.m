addpath('Levin_data');
K1 = zeros(15,15);
K2 = zeros(15,15);
% K1(11,6:15) = 0.1;
% % K2(6:15,11) = 0.1;
% K2(4:7,10) = 0.04;   K2(7,10:13) = 0.04;
% K2(7:10,13) = 0.04;   K2(10,10:13) = 0.04;
% K2(10:13,10) = 0.04;  K2(13,10:13) = 0.04;
% K2(13:16,13) = 0.04;  K2(16,10:13) = 0.04;
K1(8,3:12) = 0.1;
% K2(3:12,8) = 0.1;
% K2(3,3) = 0.07;    K2(4,4) = 0.07;
% K2(5,5) = 0.07;    K2(6,6) = 0.07;
% K2(7,7) = 0.07;    K2(8,8) = 0.07;
% K2(9,9) = 0.07;    K2(10,10) = 0.07;
% K2(11,11) = 0.07;  K2(12,12) = 0.07;
% K2(3,4) = 0.03;    K2(4,5) = 0.03;
% K2(5,6) = 0.03;    K2(6,7) = 0.03;
% K2(7,8) = 0.03;    K2(8,9) = 0.03;
% K2(9,10) = 0.03;    K2(10,11) = 0.03;
% K2(11,12) = 0.03;  K2(12,13) = 0.03;

K2(3:5,7) = 0.05;    K2(5,7:9) = 0.05;
K2(5:8,9) = 0.05;    K2(8,7:9) = 0.05;
K2(8:11,7) = 0.05;   K2(11,7:9) = 0.05;
K2(11:14,9) = 0.05;  K2(14,7:9) = 0.05;
% K2(4:6,7) = 0.11;
% K2(6:8,8) = 0.11;
% K2(8:10,9) = 0.11;

i = 0;
load('im01_ker01.mat');
LA = x;
KA = K1;
KB = imrotate(K2, i*10);
KB = imresize(KB,[15 15],'nearest');
S1 = conv2(LA, KA, 'valid');
S2 = conv2(LA, KB, 'valid');
imwrite(S1,'test1.bmp','bmp');
imwrite(S2,'test2.bmp','bmp');

deblur_demo;
subplot(2,2,1);
imshow(KA,[]);
subplot(2,2,2);
imshow(KB,[]);
subplot(2,2,3);
imshow(K(:,:,1),[]);
subplot(2,2,4);
imshow(K(:,:,2),[]);
